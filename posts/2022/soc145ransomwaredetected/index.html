<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><style type=text/css>body{font-family:monospace}</style><meta name=description content="


Quick Summary
Well, my lab time for OSWE/OSED courses just came to an end and I&rsquo;m still way to far from being able to take their respective exams (still haven&rsquo;t even reached the challenges, stuck on the material/excersises), so just as a way to take a short rest and a change of air from it, I decided to take a look around if there was anything similar to HTB but for Blue Team stuff (I barely know stuff related to it, besides my tasks as Appsec/DevSecOps whatever you want to call it mehh!), by doing this I ended up finding a web page called &ldquo;Lets Defend&rdquo;, it has some ctf alike games but focused exactly on the Blue Team side together with some Training content, which in a really easy and understandable way explains the 101 of SOC/Incident Response/SIEM, etc, pretty nice to have a quick and overview about that stuff, I liked it."><meta name=keywords content="letsdefend,soc,blue-team,ransomware,ctf"><meta name=categories content="Lets Defend"><title>SOC145 - Ransomware Detected | Ceso Adventures</title><link rel=stylesheet href=https://ceso.github.io/css/smigle-lagom.css><link rel=icon href=data:image/png,><meta name=theme-color content="#ffffff"></head><body><div id=root><header><div id=brand><a class=icon-link href=https://ceso.github.io/><img class=icon src=https://ceso.github.io/images/site/logo.svg></a><div class=text><a href=https://ceso.github.io/ class=site-title>Ceso Adventures</a><h3>Blogs, Security CTFs & Tutorials</h3></div></div><nav><a href=https://ceso.github.io/><b>Home</b></a>
|
<a href=https://ceso.github.io/whoami/><b>Whoami</b></a>
|
<a href=https://ceso.github.io/posts/><b>Posts</b></a>
|
<a href=https://ceso.github.io/cheatsheets/><b>Cheatsheets</b></a>
|
<a href=https://ceso.github.io/resources><b>Resources</b></a>
|
<a href=https://ceso.github.io/videos><b>Videos</b></a>
|
<a href=https://ceso.github.io/categories/><b>Categories</b></a>
|
<a href=https://ceso.github.io/tags/><b>Tags</b></a>
|
<a href=https://ceso.github.io/index.xml><b>RSS</b></a></nav><hr></header><div id=content><main><article><h1 class=title>SOC145 - Ransomware Detected</h1><div class=post-meta><strong><span>Posted on</span>
<time>2022-06-24</time>
<span>in</span>
<a href=https://ceso.github.io/categories/lets-defend>Lets Defend</a></strong><div><span>Tags:</span>
<a href=https://ceso.github.io/tags/letsdefend>letsdefend</a>,
<a href=https://ceso.github.io/tags/soc>soc</a>,
<a href=https://ceso.github.io/tags/blue-team>blue-team</a>,
<a href=https://ceso.github.io/tags/ransomware>ransomware</a>,
<a href=https://ceso.github.io/tags/ctf>ctf</a></div></div><pre class=asciitoc>.
├── <a href=#quick-summary>Quick Summary</a>
├── <a href=#owning-the-event>Owning the Event</a>
├── <a href=#responding-to-the-threat>Responding to the threat</a>
├── <a href=#investigating-the-threat>Investigating the threat</a>
├── <a href=#closing-the-case>Closing the case</a>
└── <a href=#final>Final</a>
</pre><div class=content><img src=https://ceso.github.io/images/letsdefend/soc145/ransomware-card.png class=center style=border-radius:8px><h2 id=quick-summary>Quick Summary</h2><p>Well, my lab time for OSWE/OSED courses just came to an end and I&rsquo;m still way to far from being able to take their respective exams (still haven&rsquo;t even reached the challenges, stuck on the material/excersises), so just as a way to take a short rest and a change of air from it, I decided to take a look around if there was anything similar to HTB but for Blue Team stuff (I barely know stuff related to it, besides my tasks as Appsec/DevSecOps whatever you want to call it mehh!), by doing this I ended up finding a web page called &ldquo;Lets Defend&rdquo;, it has some ctf alike games but focused exactly on the Blue Team side together with some Training content, which in a really easy and understandable way explains the 101 of SOC/Incident Response/SIEM, etc, pretty nice to have a quick and overview about that stuff, I liked it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>https://letsdefend.io/
</span></span></code></pre></div><p>Said that, this post is basically a walk-through of one of their challenges called &ldquo;SOC-145 - Ransomware Detected&rdquo;, the name is self-explanatory about what it is about.</p><p>Let&rsquo;s start!</p><h2 id=owning-the-event>Owning the Event</h2><p>Lets Defend has a bunch of different tools built-in (<a href=https://en.wikipedia.org/wiki/Security_information_and_event_management>SIEM</a>, <a href=https://en.wikipedia.org/wiki/Endpoint_detection_and_response>EDR</a>, Mail, Threat Intel, Case Management, Log Management) as a way for you to play their games, once in we go to the Monitoring tool (SIEM) and there we will have a lot of different events, we will see there the event SOC-145 which is the one we will own by clicking in the highlited button as shown in the screenshot.</p><img src=https://ceso.github.io/images/letsdefend/soc145/1-take-ownership.png class=center style=border-radius:8px><p>Then we will go to the Investigation tab:</p><img src=https://ceso.github.io/images/letsdefend/soc145/2-take-note-hash.png class=center style=border-radius:8px><p>So, we we have the following:</p><p>|Source Addr|Source Hostname|File Name|File Hash|
|172.16.17.88|MarkPRD|ab.exe|0b486fe0503524cfe4726a4022fa6a68|</p><p>Then let&rsquo;s proceed to create a case:</p><img src=https://ceso.github.io/images/letsdefend/soc145/3-take-create-case.png class=center style=border-radius:8px><h2 id=responding-to-the-threat>Responding to the threat</h2><p>With the data gathered, now we want to determine if this is a false positive or not, for this we pick up the File Hash obtained and search for it in Virus Total to see if there was some report of it previously and if is a malicious file (take into consideration that even if there is no finding, it still can be malicious and in that case some more in depth-analysis can be required as there can be bypasses such as layers of redirections, obfuscations, etc etc etc), what we obtain, is that indeed, it&rsquo;s a malicious file:</p><img src=https://ceso.github.io/images/letsdefend/soc145/4-virus-total-hash-1.png class=center style=border-radius:8px>
<img src=https://ceso.github.io/images/letsdefend/soc145/5-virus-total-hash-2.png class=center style=border-radius:8px><p>Knowing this, let&rsquo;s proceed to identify the machine with the IP we previously took not of in the EDR:</p><img src=https://ceso.github.io/images/letsdefend/soc145/6-identify-machine-edr.png class=center style=border-radius:8px><p>Identified the machine, let&rsquo;s proceed to isolate it:</p><img src=https://ceso.github.io/images/letsdefend/soc145/7-isolate-host.png class=center style=border-radius:8px><h2 id=investigating-the-threat>Investigating the threat</h2><p>Confirmed the presence of Malware and with the machine now isolated, we proceed on investigating what this malware does, continuing from the last action we take a look at the Process List, and compare that information with the one found in Virus Total under the &ldquo;Behaviour&rdquo; tab:</p><img src=https://ceso.github.io/images/letsdefend/soc145/8-correlate-behaviour.png class=center style=border-radius:8px><p>So, we see that this malware what it does is to start deleting shadow copies, but what are shadow copies, well from wikipedia&mldr;</p><blockquote><p>Shadow Copy (also known as Volume Snapshot Service, Volume Shadow Copy Service or VSS) is a technology included in Microsoft Windows that can create backup copies or snapshots of computer files or volumes, even when they are in use.</p></blockquote><p>So what it&rsquo;s doing is to delete volume snapshots (backups). Moving forward with the investigation we want to see if there&rsquo;s any activity on the logs, which isn&rsquo;t (the Network Connectivity also didn&rsquo;t have anything, but I don&rsquo;t feel like taking a screenshot again):</p><img src=https://ceso.github.io/images/letsdefend/soc145/9-investigation-log.png class=center style=border-radius:8px><p>Then, we want to know if this malware has any network activity (for example, connecting to a C2), for this we will leverage Hybrid Analysis (as a complement as we didn&rsquo;t find nothing in the &ldquo;Network Activity&rdquo; feature of the EDR), to carry out this task we will download the malware (remember at the time we look at the event at the beggining, the .zip to download was there), we extract it and upload that content into Hybrid Analysis, we get it flaged as malicious as expected, and proceed to take a look on one of the sandboxes where it was executed (<code>ab.bin</code> the file inside the .zip):</p><img src=https://ceso.github.io/images/letsdefend/soc145/10-investigation-hybrid-analysis.png class=center style=border-radius:8px><p>We scroll down until reaching the Network section and we find there wasn&rsquo;t registered any Network Activity:</p><img src=https://ceso.github.io/images/letsdefend/soc145/11-investigation-hybrid-analysis.png class=center style=border-radius:8px><h2 id=closing-the-case>Closing the case</h2><p>So, we were able to determine that the event on our SIEM was indeed a true positive alert, there was executed a binary called <code>ab.exe</code> which spanwed process for deleting shadow copies, and despite the machine being compromised, there wasn&rsquo;t connectivity against a C2.
Knwon this, we can proceed to close the case:</p><img src=https://ceso.github.io/images/letsdefend/soc145/12-close-alert.png class=center style=border-radius:8px>
<img src=https://ceso.github.io/images/letsdefend/soc145/13-closed-case.png class=center style=border-radius:8px><p>Didn&rsquo;t take screenshot of the process, but when closing the case, I used the following data:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>Threat indicator: other
</span></span><span style=display:flex><span>Quarantained: I put it as yes, because I didn&#39;t take a look before, this answer was wrong, it wasn&#39;t quarantained hehe
</span></span><span style=display:flex><span>Malicious
</span></span><span style=display:flex><span>C2 Not accessed
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Artifacts:
</span></span><span style=display:flex><span>    MD5 hash: 0b486fe0503524cfe4726a4022fa6a68
</span></span><span style=display:flex><span>    172.16.17.88: MarkPRD machine
</span></span></code></pre></div><h2 id=final>Final</h2><p>Well, that was all about it, an easy challenge but a nice look into the basics of how a blue team might behave when there&rsquo;s an event, from how some tools are used to the chain of thoughts made by the person who&rsquo;s working on the incident at hand.
Overall I liked the challenge and is something completly different to what I have been doing lately, and I sure learned something new even if it&rsquo;s quite basic is still nice.
I&rsquo;m sure there might be still something to look for in the investigation, for example discovering how the compromise took place, I will keep reading a bit more about methodologies etc, play a bit more applying them and see if I can find the root cause, if I find it I will edit the post to show how I did it.</p><p>Hope this helps you in some way, until the next post!</p></div></article></main><div class=post-nav><hr><div class=post-nav-left><a href=https://ceso.github.io/posts/2022/larmigsvenska.se/>&#8612; Previous Post</a></div><div class=post-nav-right><a href=https://ceso.github.io/posts/2025/zerdenken.de/>Next Post &#8614;</a></div></div><aside><h3>Latest Posts</h3><ul><li><a href=https://ceso.github.io/posts/2025/wehmutig.de/>Wehmütig</a></li><li><a href=https://ceso.github.io/posts/2025/zerdenken.de/>Zerdenken</a></li><li><a href=https://ceso.github.io/posts/2022/larmigsvenska.se/>Hur jag är lär mig svenska</a></li></ul></aside></div><footer><hr><p id=social>Find me around the web:<br><a href=https://github.com/ceso target=_blank>GitHub</a>
|
<a href=https://youtube.com/c/LeandroLemos target=_blank>YouTube</a>
|
<a href=https://twitch.tv/0xc350 target=_blank>Twitch</a></p><p class=copyright>Copyright © 2025
<a href=https://ceso.github.io/><strong>Ceso</strong></a>.</p><p class=builtWith>Built with
<a href=http://www.gohugo.io/>Hugo</a> by ceso,
using <a href=https://github.com/ceso/smigle-lagom>smigle-lagom</a> a fork of the theme
<a href=https://github.com/joe-mccarthy/smigle-lite>smigle-lite</a>. Based on the theme
<a href=https://gitlab.com/ian-s-mcb/smigle-hugo-theme>smigle</a>,
which was influenced by the theme
<a href=https://github.com/colorchestra/smol>smol</a>.</p></footer></div></body></html>